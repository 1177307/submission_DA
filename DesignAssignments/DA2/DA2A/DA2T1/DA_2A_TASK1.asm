;
; DA_2A_TASK1_ASM.asm
;
; Created: 3/2/2019 6:41:36 PM
; Author : TheodorePele

;DESIGN A DELAY SUBROUTINE TO GENERATE A WAVEFORM ON PORTB.2
;WITH 60% DC AND 0.725 SEC PERIOD
;so 60% of 0.725 is 0.435 and low for 0.290

;ENDED UP USING EXCEL TO CREATE VALUES FOR R19,R20,R21
;TO CREATE DESIRED PERIOD VALUES
;FOR 1Mhz
; 2, 189, 255 USED APPROX. 290310 CYCLES
; 3, 189, 255 USED APPROX. 435465 CYCLES
;FOR 16Mhz
;40, 227, 254 USED APPROX 0.434ms
;27, 227, 254 used approx 0.293ms

;SO I JUST LOADED R19 BEFORE THE DELAY WERE CALLED

start:
	LDI R16, 0xFF ;USED TO FOR INITIALIZATION
	OUT DDRB, R16 ;MAKES PORTB AN OUTPUT PORT
L1:
	SBI DDRB, 2
	LDI R19, 40	  ;USED FOR DELAY FUNCTION TO GENERATE 0.435 ms
	CALL DELAY	  ;DELAY SUBROUTINE IS CALLED
	CBI DDRB, 2	  ;CLEAR BIT PB5 TO TURN OFF OR LOW
	CALL DELAY
	RJMP L1

DELAY:
	;LDI R19, 3
DELAY0:			  ;USED FOR LABEL FOR BRANCH INSTRUCTION
	LDI R20, 227
DELAY1:
	LDI R21, 254
DELAY2:
	DEC R21
	BRNE DELAY2 ;DECREASES R21 IF NOT EQUAL TO ZERO KEEP DECREMENTING
	DEC R20
	BRNE DELAY1 ;CHECKS R20 IF EQUAL TO ZERO
	DEC R19
	BRNE DELAY0 ;CHECKS R19 IF EQUAL TO ZERO
	LDI R19, 27  ;USED FOR SECOND CALL TO GENERATE 0.290 ms
	RET			;RETURNS TO CALL FUNCTION