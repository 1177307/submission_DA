;
; DA_2A_TASK2_ASM.asm
;
; Created: 3/2/2019 6:41:36 PM
; Author : TheodorePele


/*connect a sw to portc.2 to poll for an event to turn on 
LED at portb.2 for 1.250 sec after envt*/

;ENDED UP USING EXCEL TO CREATE VALUES FOR R19,R20,R21
;TO CREATE DESIRED PERIOD VALUES
;FOR 1Mhz
; 2, 189, 255 USED APPROX. 290310 CYCLES
; 3, 189, 255 USED APPROX. 435465 CYCLES
;FOR 16Mhz
;40, 227, 254 USED APPROX 0.434ms
;27, 227, 254 used approx 0.293ms
;102,255, 255 used to generate approx 1.25 (1.248499seconds)

;SO I JUST LOADED R19 BEFORE THE DELAY WERE CALLED

start:
	LDI R16, 0x02 ;USED TO FOR INITIALIZATION
	LDI R17, 0xFC ;USED FOR INPUT DECLARATION
	OUT DDRB, R16 ;MAKES PORTB AN OUTPUT PORT
	OUT DDRC, R17 ;MAKES PORTC AN INPUT AND ENABLES PULL-UP
L1:	
	IN  R20, PINC ;CHECKS PINS
	CPI R20, 0	  ;IF 0 THEN SW WAS PRESSED
	BRNE L1		  ;SO IF EQUAL THEN IT KEEPS LOOPING UNTIL ITS TRUE
	SBI DDRB, 2	  ;SWITCHES LED ON
	CALL DELAY	  ;DELAY SUBROUTINE IS CALLED
	CBI DDRB, 2	  ;CLEAR BIT PB5 TO TURN OFF OR LOW
	RJMP L1

DELAY:
	LDI R19, 102
DELAY0:			  ;USED FOR LABEL FOR BRANCH INSTRUCTION
	LDI R20, 227
DELAY1:
	LDI R21, 254
DELAY2:
	DEC R21
	BRNE DELAY2 ;DECREASES R21 IF NOT EQUAL TO ZERO KEEP DECREMENTING
	DEC R20
	BRNE DELAY1 ;CHECKS R20 IF EQUAL TO ZERO
	DEC R19
	BRNE DELAY0 ;CHECKS R19 IF EQUAL TO ZERO
	LDI R19, 27  ;USED FOR SECOND CALL TO GENERATE 0.290 ms
	RET			;RETURNS TO CALL FUNCTION